{% extends 'base.html' %}
{% block content %}
<div class="actions-bar">
  <div class="mode-group">
    <span class="mode-label">场景模式：</span>
    <button class="mode-btn" data-mode="eco">节能</button>
    <button class="mode-btn active" data-mode="warm">暖光</button>
    <button class="mode-btn" data-mode="breathing">呼吸</button>
    <button class="mode-btn" data-mode="high">强光</button>
    <button class="mode-btn" data-mode="off">关闭</button>
  </div>
</div>
<div class="grid" style="grid-template-columns:1fr 1fr;">
  <section class="panel">
    <h2>能源分配</h2>
    <div id="energy-distribution" class="energy-distribution">
      <div class="tariff">
        <span>电费模式</span>
        <button id="tariff-toggle" class="toggle-btn" data-mode="low">低电价</button>
      </div>
      <svg id="energy-flows" class="flow-svg"></svg>
      <div class="node grid" id="node-grid"><div class="label">电网</div><div class="value"><div class="val-orange"><span id="val-grid-to-batt-kwh">0 kWh</span></div><div class="val-blue"><span id="val-grid-to-house-kwh">0 kWh</span></div></div></div>
      <div class="node battery" id="node-battery"><div class="label">电池</div><div class="value"><div class="icon-orange">⚡ <span id="val-batt-charge-kw">0 kW</span></div><div class="icon-blue">⚡ <span id="val-batt-to-house-kw">0 kW</span></div><div class="icon-orange">🔋 <span id="val-batt-soc">0%</span> / <span id="val-batt-rem-kwh">0 kWh</span> · <span id="val-batt-time-left">0 h</span></div></div></div>
      <div class="node house" id="node-house"><div class="label">建筑</div><div class="value" id="val-house">0 kWh</div><div class="sub">供电来源：<span id="supply-source">电网</span></div></div>
    </div>
  </section>
  <section class="panel">
    <h2>数据源</h2>
    <div id="energy-sources-table" class="sources-table"></div>
  </section>
  <section class="panel">
    <h2>电源</h2>
    <div class="legend-note"><span class="legend-dot blue"></span>电网 <span class="legend-dot pink"></span>电池 <span class="legend-dot orange"></span>建筑</div>
    <div id="energy-power-chart" style="width:100%;height:320px;"></div>
  </section>
  <section class="panel">
    <h2>用电量</h2>
    <div class="legend-note"><span class="legend-dot blue"></span>电网 <span class="legend-dot pink"></span>电池 <span class="legend-dot orange"></span>建筑</div>
    <div id="energy-consumption-chart" style="width:100%;height:320px;"></div>
  </section>
  <section class="panel">
    <h2>电价历史</h2>
    <div class="chart-tabs" id="price-tabs">
      <button data-period="realtime" class="tab active">实时</button>
      <button data-period="day" class="tab">天</button>
      <button data-period="week" class="tab">周</button>
      <button data-period="month" class="tab">月</button>
    </div>
    <div class="chart-controls">
      <select id="price-unit">
        <option value="CNY">元/kWh</option>
        <option value="USD">$/kWh</option>
        <option value="EUR">€/kWh</option>
      </select>
      <button id="price-refresh">刷新</button>
    </div>
    <div id="price-chart" style="width:100%;height:280px;"></div>
  </section>
  <section class="panel">
    <h2>电费历史</h2>
    <div class="chart-tabs" id="fee-tabs">
      <button data-period="realtime" class="tab active">实时</button>
      <button data-period="day" class="tab">天</button>
      <button data-period="week" class="tab">周</button>
      <button data-period="month" class="tab">月</button>
    </div>
    <div class="chart-controls">
      <select id="fee-unit">
        <option value="CNY">元</option>
        <option value="USD">$</option>
        <option value="EUR">€</option>
      </select>
      <button id="fee-refresh">刷新</button>
    </div>
    <div id="fee-chart" style="width:100%;height:280px;"></div>
  </section>
</div>
{% endblock %}
